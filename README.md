## Wordpress Notification Center

### 概要

Wordpress（WP）間の更新情報を共有する仕組み

### 仕様

#### 1. 通知サーバー

管理下にあるWPからの記事をデータベースに保存する。
各WPは必要に応じて、APIを通じてデータベース内の情報を取得し、利用することができる。
管理画面の構築には、Twitter Bootstrap等のCSSフレームワークを用い、簡略化する（要検討）

##### 1-a. 通知データの保存

- 各Wordpressからpushされてきたデータを、データベースに保存する
- 保存する情報は、「記事ID」「タイトル」「本文」「タグ」「アイキャッチ画像」「公開日時」といったWordpressのデータ及び、「WPID（通知システム内に保存した登録WPのID）」とし、「カテゴリ」「ユーザー」は受信先の設定に合わせて付け替えられる
- カスタムフィールドは送受信しない。
- （一応）簡単に削除なども可能な管理画面も欲しいですね。リストだけでOKだと思いますが。

##### 1-b. 通知データの出力

- 各WPにはAPI経由で、現在当該WPに対して通知されている記事の一覧を出力する
- 出力にはJSONを用いる（要検討）
- APIKeyを発行して、API出力の際に照会する

##### 1-c. Wordpressサイトの管理

- Wordpressサイトを登録／管理出来るUIが必要
- 管理する情報は、「ID」「サイト名」「URL」「APIKey」「E-Mail」（要検討）

---

#### 2. Wordpressプラグイン

##### 2-a. Push

- 通知システムに更新情報を送信する
- 送信する情報は、WPが持つ「記事ID」「タイトル」「本文」「アイキャッチ画像」「タグ」「公開日時」といったデータ及び、「WPのBASEURL（DBで照会される）」「送信するWPID（複数）」。（要検討）
- 送信するタイミングは、管理ページで通知用のボタンを押したタイミングとする。インターフェイスが難しいですね。
- 更新／削除のタイミングでも更新情報が送信され、各WPに取り込まれる前の記事データであれば変更が反映される

##### 2-b. Pull

- 当該WPへの通知情報を取得する
- 管理画面及び、ダッシュボードへのウィジェットが欲しいが、APIは同一のものを使うようにする。
- 管理画面からは、「記事データの削除リクエスト」「記事データの取り込み（Merge）」が行える

##### 2-c. Merge

- Pullした記事データを当該WPの記事データとして取り込むことが出来る
- デフォルトでは下書き状態とする
- 「カテゴリ」「ユーザー」は、設定画面で設定したものになる（送信元WPの設定は引き継がない）
- 取り込まれたデータは、通知センターから削除される（複数のWPに送っているものについては、当該WPのものだけ削除される）

##### 2-d. Setting

以下の設定項目がある

- 受信した記事のカテゴリ：該当カテゴリが削除された場合、スラッグが変更された場合の処理に留意すること
- 受信した記事のユーザー：該当ユーザーが削除された場合、ユーザー名が変更になった場合の処理に留意すること
- 送信するデータに付加するタグ

